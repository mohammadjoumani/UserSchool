package com.example.userschool.view.fragment;import android.content.BroadcastReceiver;import android.content.Context;import android.content.Intent;import android.content.IntentFilter;import android.content.SharedPreferences;import android.os.Bundle;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.ImageView;import android.widget.ProgressBar;import android.widget.TableLayout;import androidx.annotation.NonNull;import androidx.fragment.app.Fragment;import androidx.recyclerview.widget.LinearLayoutManager;import androidx.recyclerview.widget.RecyclerView;import com.example.userschool.R;import com.example.userschool.connectdb.ConnectDB;import com.example.userschool.model.Marks;import com.example.userschool.query.StudentQuery;import com.example.userschool.view.activity.StudentActivity;import com.example.userschool.view.adapter.MarkStudentRecyclerAdapter;import java.util.ArrayList;import java.util.List;import static android.content.Context.MODE_PRIVATE;public class MarksStudentFragment extends Fragment {    private TableLayout tableLayoutMarksFragment;    private ProgressBar progressBarMarksStudentFragment;    private ImageView imgMarksStudentFragmentEmpty;    private RecyclerView recyclerFragmentMarksStudent;    private RecyclerView.LayoutManager layoutManagerMarks;    private List<Marks> marks;    private MarkStudentRecyclerAdapter markStudentRecyclerAdapter;    private ConnectDB connectDB;    private StudentQuery studentQuery;    private SharedPreferences sharedPreferences;    private int studentID;    public View onCreateView(@NonNull LayoutInflater inflater,                             ViewGroup container,                             Bundle savedInstanceState) {        View view = inflater.inflate( R.layout.fragment_marks_student, container, false );        sharedPreferences = getActivity().getSharedPreferences( "studentID", MODE_PRIVATE );        studentID = sharedPreferences.getInt( "studentID", 0 );        connectDB = new ConnectDB();        studentQuery = new StudentQuery( getActivity() );        tableLayoutMarksFragment = view.findViewById( R.id.tableLayoutMarksFragment );        progressBarMarksStudentFragment = view.findViewById( R.id.progressBarMarksStudentFragment );        imgMarksStudentFragmentEmpty = view.findViewById( R.id.imgMarksStudentFragmentEmpty );        recyclerFragmentMarksStudent = view.findViewById( R.id.recyclerFragmentMarksStudent );        //recycler for show studnet marks        recyclerFragmentMarksStudent.setHasFixedSize( true );        layoutManagerMarks = new LinearLayoutManager( getActivity(), RecyclerView.VERTICAL, false );        recyclerFragmentMarksStudent.setLayoutManager( layoutManagerMarks );        marks = new ArrayList<>();        studentQuery.callTaskGetMarks(studentID);        markStudentRecyclerAdapter = new MarkStudentRecyclerAdapter( getActivity(), marks );        recyclerFragmentMarksStudent.setAdapter( markStudentRecyclerAdapter );        progressBarMarksStudentFragment.setVisibility( View.VISIBLE );        IntentFilter intentFilterMarks = new IntentFilter( "listMarks" );        requireActivity().registerReceiver( broadcastReceiverMarks, intentFilterMarks );        return view;    }    BroadcastReceiver broadcastReceiverMarks = new BroadcastReceiver() {        @Override        public void onReceive(Context context, Intent intent) {            if (connectDB.CONN() == null) {                progressBarMarksStudentFragment.setVisibility( View.GONE );                imgMarksStudentFragmentEmpty.setImageResource( R.drawable.ic_disconnect );                imgMarksStudentFragmentEmpty.setVisibility( View.VISIBLE );                tableLayoutMarksFragment.setVisibility( View.GONE );                return;            }            marks = studentQuery.getMarks();            if (marks.size() == 0) {                imgMarksStudentFragmentEmpty.setVisibility( View.VISIBLE );            } else {                imgMarksStudentFragmentEmpty.setVisibility( View.GONE );            }            markStudentRecyclerAdapter.setData( marks );            progressBarMarksStudentFragment.setVisibility( View.GONE );        }    };}